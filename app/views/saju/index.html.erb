<h1>🔮 신비한 AI 사주풀이</h1>

<%= form_with url: saju_stream_path, method: :post, local: true do |f| %>
  <div>
    <%= f.label :name, "이름" %>
    <%= f.text_field :name, required: true %>
  </div>
  <div>
    <%= f.label :birth_date, "생년월일" %>
    <%= f.date_field :birth_date, required: true %>
  </div>
  <div>
    <%= f.label :birth_time, "태어난 시간" %>
    <%= f.time_field :birth_time %>
  </div>
  <div>
    <%= f.label :city, "태어난 도시" %>
    <%= f.text_field :city %>
  </div>
  
  <div style="margin-top: 20px;">
    <%= f.submit "운세 보기 (5초 정도 걸려요)", class: "btn", onclick: "this.value='도사님 접신 중...'; this.disabled=true; this.form.submit();" %>
  </div>
<% end %>

<hr>

<!-- 결과가 있을 때만 보여줌 -->
<% if @result_text.present? %>
  <div class="saju-result-content" style="background-color: #ffffff; padding: 30px; border: 1px solid #e2e8f0; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.05);">
    <!-- 마크다운 변환해서 보여주기 -->
    <% renderer = Redcarpet::Render::HTML.new(hard_wrap: true) %>
    <% markdown = Redcarpet::Markdown.new(renderer) %>
    <%= markdown.render(@result_text).html_safe %>
  </div>
<% end %>